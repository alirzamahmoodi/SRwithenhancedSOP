2025-04-09 13:11:26,908 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:11:26,920 - root - INFO - Starting database monitor mode...
2025-04-09 13:11:27,290 - root - INFO - Connected to Oracle database for monitoring.
2025-04-09 13:11:27,298 - root - INFO - Detected study 1 with REPORT_STAT '3010'.
2025-04-09 13:11:27,301 - root - INFO - Created new study record for 1 with status received
2025-04-09 13:11:27,302 - root - INFO - Added study 1 to processing queue.
2025-04-09 13:11:27,302 - root - INFO - Processing study key from queue: 1
2025-04-09 13:11:27,303 - root - INFO - Detected study 53 with REPORT_STAT '3010'.
2025-04-09 13:11:27,306 - root - INFO - Created new study record for 53 with status received
2025-04-09 13:11:27,309 - root - INFO - Added study 53 to processing queue.
2025-04-09 13:11:27,309 - root - INFO - Detected study 22 with REPORT_STAT '3010'.
2025-04-09 13:11:27,312 - root - INFO - Created new study record for 22 with status received
2025-04-09 13:11:27,313 - root - INFO - Added study 22 to processing queue.
2025-04-09 13:11:29,371 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:11:29,378 - root - INFO - Created new study record for 1 with status processing_query
2025-04-09 13:11:29,378 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:11:29,378 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:11:29,379 - root - INFO - Connecting to Oracle database.
2025-04-09 13:11:29,426 - root - INFO - Creating cursor for database operations.
2025-04-09 13:11:35,801 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:11:36,212 - root - ERROR - Subprocess for 1 failed with code 1.
2025-04-09 13:11:36,213 - root - ERROR - Subprocess stderr: 2025-04-09 13:11:29,371 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:11:29,378 - root - INFO - Created new study record for 1 with status processing_query
2025-04-09 13:11:29,378 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:11:29,378 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:11:29,379 - root - INFO - Connecting to Oracle database.
2025-04-09 13:11:29,426 - root - INFO - Creating cursor for database operations.
2025-04-09 13:11:35,801 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm

2025-04-09 13:11:36,216 - root - INFO - Updated study 1 status to error
2025-04-09 13:11:36,216 - root - INFO - Processing study key from queue: 53
2025-04-09 13:11:38,286 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:11:38,292 - root - INFO - Created new study record for 53 with status processing_query
2025-04-09 13:11:38,292 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:11:38,293 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:11:38,293 - root - INFO - Connecting to Oracle database.
2025-04-09 13:11:38,363 - root - INFO - Creating cursor for database operations.
2025-04-09 13:11:46,727 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:11:47,045 - root - ERROR - Subprocess for 53 failed with code 1.
2025-04-09 13:11:47,046 - root - ERROR - Subprocess stderr: 2025-04-09 13:11:38,286 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:11:38,292 - root - INFO - Created new study record for 53 with status processing_query
2025-04-09 13:11:38,292 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:11:38,293 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:11:38,293 - root - INFO - Connecting to Oracle database.
2025-04-09 13:11:38,363 - root - INFO - Creating cursor for database operations.
2025-04-09 13:11:46,727 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm

2025-04-09 13:11:47,049 - root - INFO - Updated study 53 status to error
2025-04-09 13:11:47,049 - root - INFO - Processing study key from queue: 22
2025-04-09 13:11:49,179 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:11:49,186 - root - INFO - Created new study record for 22 with status processing_query
2025-04-09 13:11:49,186 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:11:49,186 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:11:49,186 - root - INFO - Connecting to Oracle database.
2025-04-09 13:11:49,255 - root - INFO - Creating cursor for database operations.
2025-04-09 13:11:49,259 - root - ERROR - No TDICTATION record found for REPORT_KEY=63
2025-04-09 13:11:49,794 - root - ERROR - Subprocess for 22 failed with code 1.
2025-04-09 13:11:49,794 - root - ERROR - Subprocess stderr: 2025-04-09 13:11:49,179 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:11:49,186 - root - INFO - Created new study record for 22 with status processing_query
2025-04-09 13:11:49,186 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:11:49,186 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:11:49,186 - root - INFO - Connecting to Oracle database.
2025-04-09 13:11:49,255 - root - INFO - Creating cursor for database operations.
2025-04-09 13:11:49,259 - root - ERROR - No TDICTATION record found for REPORT_KEY=63

2025-04-09 13:11:49,797 - root - INFO - Updated study 22 status to error
2025-04-09 13:12:27,351 - root - INFO - Detected study 1 with REPORT_STAT '3010'.
2025-04-09 13:12:27,352 - root - INFO - Updated study 1 status to received
2025-04-09 13:12:27,353 - root - INFO - Added study 1 to processing queue.
2025-04-09 13:12:27,353 - root - INFO - Processing study key from queue: 1
2025-04-09 13:12:27,353 - root - INFO - Detected study 53 with REPORT_STAT '3010'.
2025-04-09 13:12:27,355 - root - INFO - Updated study 53 status to received
2025-04-09 13:12:27,356 - root - INFO - Added study 53 to processing queue.
2025-04-09 13:12:27,356 - root - INFO - Detected study 22 with REPORT_STAT '3010'.
2025-04-09 13:12:27,358 - root - INFO - Updated study 22 status to received
2025-04-09 13:12:27,358 - root - INFO - Added study 22 to processing queue.
2025-04-09 13:12:29,417 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:12:29,423 - root - INFO - Updated study 1 status to processing_query
2025-04-09 13:12:29,424 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:12:29,424 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:12:29,424 - root - INFO - Connecting to Oracle database.
2025-04-09 13:12:29,496 - root - INFO - Creating cursor for database operations.
2025-04-09 13:12:35,727 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:12:36,157 - root - ERROR - Subprocess for 1 failed with code 1.
2025-04-09 13:12:36,158 - root - ERROR - Subprocess stderr: 2025-04-09 13:12:29,417 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:12:29,423 - root - INFO - Updated study 1 status to processing_query
2025-04-09 13:12:29,424 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:12:29,424 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:12:29,424 - root - INFO - Connecting to Oracle database.
2025-04-09 13:12:29,496 - root - INFO - Creating cursor for database operations.
2025-04-09 13:12:35,727 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm

2025-04-09 13:12:36,161 - root - INFO - Updated study 1 status to error
2025-04-09 13:12:36,162 - root - INFO - Processing study key from queue: 53
2025-04-09 13:12:38,175 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:12:38,184 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:12:38,184 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:12:38,184 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:12:38,185 - root - INFO - Connecting to Oracle database.
2025-04-09 13:12:38,259 - root - INFO - Creating cursor for database operations.
2025-04-09 13:12:46,488 - root - INFO - Database monitoring stopped by user.
2025-04-09 13:12:46,947 - root - ERROR - Subprocess for 53 failed with code 3221225786.
2025-04-09 13:12:46,947 - root - ERROR - Subprocess stderr: 2025-04-09 13:12:38,175 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:12:38,184 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:12:38,184 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:12:38,184 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:12:38,185 - root - INFO - Connecting to Oracle database.
2025-04-09 13:12:38,259 - root - INFO - Creating cursor for database operations.
Traceback (most recent call last):
  File "E:\SRwithenhancedSOP\main.py", line 164, in <module>
    main()
  File "E:\SRwithenhancedSOP\main.py", line 159, in main
    run_pipeline(args.STUDY_KEY)
  File "E:\SRwithenhancedSOP\main.py", line 53, in run_pipeline
    final_path = process_study_key(config, study_key)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\SRwithenhancedSOP\modules\query.py", line 64, in process_study_key
    logging.error(f"File not found at constructed path: {final_path}")
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\logging\__init__.py", line 2100, in error
    def error(msg, *args, **kwargs):
    
KeyboardInterrupt

2025-04-09 13:12:46,952 - root - INFO - Updated study 53 status to error
2025-04-09 13:27:08,571 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:27:08,578 - root - INFO - Starting database monitor mode...
2025-04-09 13:27:08,640 - root - INFO - Connected to Oracle database for monitoring.
2025-04-09 13:27:08,645 - root - INFO - Detected study 1 with REPORT_STAT '3010'.
2025-04-09 13:27:08,647 - root - INFO - Updated study 1 status to received
2025-04-09 13:27:08,647 - root - INFO - Added study 1 to processing queue.
2025-04-09 13:27:08,647 - root - INFO - Processing study key from queue: 1
2025-04-09 13:27:08,648 - root - INFO - Detected study 53 with REPORT_STAT '3010'.
2025-04-09 13:27:08,649 - root - INFO - Updated study 53 status to received
2025-04-09 13:27:08,650 - root - INFO - Added study 53 to processing queue.
2025-04-09 13:27:08,650 - root - INFO - Detected study 22 with REPORT_STAT '3010'.
2025-04-09 13:27:08,652 - root - INFO - Updated study 22 status to received
2025-04-09 13:27:08,653 - root - INFO - Added study 22 to processing queue.
2025-04-09 13:27:10,612 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:27:10,619 - root - INFO - Updated study 1 status to processing_query
2025-04-09 13:27:10,619 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:27:10,619 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:27:10,620 - root - INFO - Connecting to Oracle database.
2025-04-09 13:27:10,666 - root - INFO - Creating cursor for database operations.
2025-04-09 13:27:10,680 - root - INFO - DICOM file path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:27:10,680 - root - INFO - UNC path detected: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm. Attempting network share connection.
2025-04-09 13:27:10,681 - root - INFO - Attempting connection to network share: \\172.31.100.60\Longterm
2025-04-09 13:27:10,796 - root - WARNING - Connection to \\172.31.100.60\Longterm likely already exists or conflicts: Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Code: 1219). Assuming access is possible.
2025-04-09 13:27:10,796 - root - INFO - Network share connection successful or already established.
2025-04-09 13:27:10,797 - root - INFO - Updated study 1 status to processing_audio
2025-04-09 13:27:10,798 - detailed - INFO - Extracting audio from DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:27:10,881 - detailed - INFO - DICOM file read successfully on attempt 1
2025-04-09 13:27:10,881 - detailed - INFO - Waveform extracted from DICOM file.
2025-04-09 13:27:10,904 - detailed - INFO - Audio extracted and saved to: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:27:10,906 - root - INFO - Updated study 1 status to transcribing
2025-04-09 13:27:10,906 - detailed - INFO - Transcribing audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav for DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:27:10,906 - detailed - DEBUG - Reading DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:27:10,915 - detailed - DEBUG - DICOM file read successfully
2025-04-09 13:27:10,915 - detailed - DEBUG - Uploading audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav to Gemini API
2025-04-09 13:27:12,136 - googleapiclient.http - WARNING - Invalid JSON content from response: b'<!DOCTYPE html>\n<html lang=en>\n  <meta charset=utf-8>\n  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">\n  <title>Error 403 (Forbidden)!!1</title>\n  <style>\n    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}\n  </style>\n  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>\n  <p><b>403.</b> <ins>That\xe2\x80\x99s an error.</ins>\n  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That\xe2\x80\x99s all we know.</ins>\n'
2025-04-09 13:27:12,137 - detailed - ERROR - Unexpected error while uploading audio: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">
2025-04-09 13:27:12,177 - detailed - DEBUG - Traceback (most recent call last):
  File "E:\SRwithenhancedSOP\modules\transcribe.py", line 41, in transcribe
    uploaded_file = genai.upload_file(audio_path)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 103, in create_file
    self._setup_discovery_api(metadata)
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 84, in _setup_discovery_api
    response, content = request.execute()
                        ^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">

2025-04-09 13:27:12,179 - root - WARNING - No transcription was generated.
2025-04-09 13:27:12,180 - root - INFO - Updated study 1 status to error
2025-04-09 13:27:12,193 - root - INFO - Temporary audio file deleted: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:27:14,812 - root - INFO - Subprocess for 1 completed successfully.
2025-04-09 13:27:14,812 - root - INFO - Processing study key from queue: 53
2025-04-09 13:27:16,802 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:27:16,809 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:27:16,809 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:27:16,809 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:27:16,809 - root - INFO - Connecting to Oracle database.
2025-04-09 13:27:16,882 - root - INFO - Creating cursor for database operations.
2025-04-09 13:27:16,894 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:27:17,434 - root - ERROR - Subprocess for 53 failed with code 1.
2025-04-09 13:27:17,435 - root - ERROR - Subprocess stderr: 2025-04-09 13:27:16,802 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:27:16,809 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:27:16,809 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:27:16,809 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:27:16,809 - root - INFO - Connecting to Oracle database.
2025-04-09 13:27:16,882 - root - INFO - Creating cursor for database operations.
2025-04-09 13:27:16,894 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm

2025-04-09 13:27:17,437 - root - INFO - Updated study 53 status to error
2025-04-09 13:27:17,438 - root - INFO - Processing study key from queue: 22
2025-04-09 13:27:19,414 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:27:19,426 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:27:19,426 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:27:19,427 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:27:19,427 - root - INFO - Connecting to Oracle database.
2025-04-09 13:27:19,493 - root - INFO - Creating cursor for database operations.
2025-04-09 13:27:19,499 - root - ERROR - No TDICTATION record found for REPORT_KEY=63
2025-04-09 13:27:20,053 - root - ERROR - Subprocess for 22 failed with code 1.
2025-04-09 13:27:20,054 - root - ERROR - Subprocess stderr: 2025-04-09 13:27:19,414 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:27:19,426 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:27:19,426 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:27:19,427 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:27:19,427 - root - INFO - Connecting to Oracle database.
2025-04-09 13:27:19,493 - root - INFO - Creating cursor for database operations.
2025-04-09 13:27:19,499 - root - ERROR - No TDICTATION record found for REPORT_KEY=63

2025-04-09 13:27:20,056 - root - INFO - Updated study 22 status to error
2025-04-09 13:28:08,690 - root - INFO - Detected study 1 with REPORT_STAT '3010'.
2025-04-09 13:28:08,691 - root - INFO - Updated study 1 status to received
2025-04-09 13:28:08,692 - root - INFO - Added study 1 to processing queue.
2025-04-09 13:28:08,692 - root - INFO - Processing study key from queue: 1
2025-04-09 13:28:08,692 - root - INFO - Detected study 53 with REPORT_STAT '3010'.
2025-04-09 13:28:08,694 - root - INFO - Updated study 53 status to received
2025-04-09 13:28:08,694 - root - INFO - Added study 53 to processing queue.
2025-04-09 13:28:08,695 - root - INFO - Detected study 22 with REPORT_STAT '3010'.
2025-04-09 13:28:08,696 - root - INFO - Updated study 22 status to received
2025-04-09 13:28:08,697 - root - INFO - Added study 22 to processing queue.
2025-04-09 13:28:10,657 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:28:10,664 - root - INFO - Updated study 1 status to processing_query
2025-04-09 13:28:10,664 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:28:10,664 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:28:10,665 - root - INFO - Connecting to Oracle database.
2025-04-09 13:28:10,739 - root - INFO - Creating cursor for database operations.
2025-04-09 13:28:10,754 - root - INFO - DICOM file path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:28:10,754 - root - INFO - UNC path detected: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm. Attempting network share connection.
2025-04-09 13:28:10,754 - root - INFO - Attempting connection to network share: \\172.31.100.60\Longterm
2025-04-09 13:28:10,780 - root - WARNING - Connection to \\172.31.100.60\Longterm likely already exists or conflicts: Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Code: 1219). Assuming access is possible.
2025-04-09 13:28:10,780 - root - INFO - Network share connection successful or already established.
2025-04-09 13:28:10,781 - root - INFO - Updated study 1 status to processing_audio
2025-04-09 13:28:10,781 - detailed - INFO - Extracting audio from DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:28:10,821 - detailed - INFO - DICOM file read successfully on attempt 1
2025-04-09 13:28:10,821 - detailed - INFO - Waveform extracted from DICOM file.
2025-04-09 13:28:10,843 - detailed - INFO - Audio extracted and saved to: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:28:10,845 - root - INFO - Updated study 1 status to transcribing
2025-04-09 13:28:10,845 - detailed - INFO - Transcribing audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav for DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:28:10,845 - detailed - DEBUG - Reading DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:28:10,856 - detailed - DEBUG - DICOM file read successfully
2025-04-09 13:28:10,856 - detailed - DEBUG - Uploading audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav to Gemini API
2025-04-09 13:28:11,598 - googleapiclient.http - WARNING - Invalid JSON content from response: b'<!DOCTYPE html>\n<html lang=en>\n  <meta charset=utf-8>\n  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">\n  <title>Error 403 (Forbidden)!!1</title>\n  <style>\n    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}\n  </style>\n  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>\n  <p><b>403.</b> <ins>That\xe2\x80\x99s an error.</ins>\n  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That\xe2\x80\x99s all we know.</ins>\n'
2025-04-09 13:28:11,599 - detailed - ERROR - Unexpected error while uploading audio: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">
2025-04-09 13:28:11,602 - detailed - DEBUG - Traceback (most recent call last):
  File "E:\SRwithenhancedSOP\modules\transcribe.py", line 41, in transcribe
    uploaded_file = genai.upload_file(audio_path)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 103, in create_file
    self._setup_discovery_api(metadata)
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 84, in _setup_discovery_api
    response, content = request.execute()
                        ^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">

2025-04-09 13:28:11,603 - root - WARNING - No transcription was generated.
2025-04-09 13:28:11,605 - root - INFO - Updated study 1 status to error
2025-04-09 13:28:11,623 - root - INFO - Temporary audio file deleted: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:28:13,837 - root - INFO - Subprocess for 1 completed successfully.
2025-04-09 13:28:13,838 - root - INFO - Processing study key from queue: 53
2025-04-09 13:28:15,848 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:28:15,866 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:28:15,867 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:28:15,867 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:28:15,867 - root - INFO - Connecting to Oracle database.
2025-04-09 13:28:15,943 - root - INFO - Creating cursor for database operations.
2025-04-09 13:28:15,952 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:28:16,473 - root - ERROR - Subprocess for 53 failed with code 1.
2025-04-09 13:28:16,474 - root - ERROR - Subprocess stderr: 2025-04-09 13:28:15,848 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:28:15,866 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:28:15,867 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:28:15,867 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:28:15,867 - root - INFO - Connecting to Oracle database.
2025-04-09 13:28:15,943 - root - INFO - Creating cursor for database operations.
2025-04-09 13:28:15,952 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm

2025-04-09 13:28:16,477 - root - INFO - Updated study 53 status to error
2025-04-09 13:28:16,478 - root - INFO - Processing study key from queue: 22
2025-04-09 13:28:18,456 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:28:18,473 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:28:18,473 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:28:18,474 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:28:18,474 - root - INFO - Connecting to Oracle database.
2025-04-09 13:28:18,554 - root - INFO - Creating cursor for database operations.
2025-04-09 13:28:18,562 - root - ERROR - No TDICTATION record found for REPORT_KEY=63
2025-04-09 13:28:19,100 - root - ERROR - Subprocess for 22 failed with code 1.
2025-04-09 13:28:19,100 - root - ERROR - Subprocess stderr: 2025-04-09 13:28:18,456 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:28:18,473 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:28:18,473 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:28:18,474 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:28:18,474 - root - INFO - Connecting to Oracle database.
2025-04-09 13:28:18,554 - root - INFO - Creating cursor for database operations.
2025-04-09 13:28:18,562 - root - ERROR - No TDICTATION record found for REPORT_KEY=63

2025-04-09 13:28:19,103 - root - INFO - Updated study 22 status to error
2025-04-09 13:29:08,736 - root - INFO - Detected study 1 with REPORT_STAT '3010'.
2025-04-09 13:29:08,738 - root - INFO - Updated study 1 status to received
2025-04-09 13:29:08,738 - root - INFO - Added study 1 to processing queue.
2025-04-09 13:29:08,738 - root - INFO - Processing study key from queue: 1
2025-04-09 13:29:08,739 - root - INFO - Detected study 53 with REPORT_STAT '3010'.
2025-04-09 13:29:08,741 - root - INFO - Updated study 53 status to received
2025-04-09 13:29:08,742 - root - INFO - Added study 53 to processing queue.
2025-04-09 13:29:08,742 - root - INFO - Detected study 22 with REPORT_STAT '3010'.
2025-04-09 13:29:08,743 - root - INFO - Updated study 22 status to received
2025-04-09 13:29:08,744 - root - INFO - Added study 22 to processing queue.
2025-04-09 13:29:10,787 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:29:10,794 - root - INFO - Updated study 1 status to processing_query
2025-04-09 13:29:10,794 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:29:10,794 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:29:10,795 - root - INFO - Connecting to Oracle database.
2025-04-09 13:29:10,885 - root - INFO - Creating cursor for database operations.
2025-04-09 13:29:10,899 - root - INFO - DICOM file path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:29:10,899 - root - INFO - UNC path detected: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm. Attempting network share connection.
2025-04-09 13:29:10,899 - root - INFO - Attempting connection to network share: \\172.31.100.60\Longterm
2025-04-09 13:29:11,073 - root - WARNING - Connection to \\172.31.100.60\Longterm likely already exists or conflicts: Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Code: 1219). Assuming access is possible.
2025-04-09 13:29:11,073 - root - INFO - Network share connection successful or already established.
2025-04-09 13:29:11,074 - root - INFO - Updated study 1 status to processing_audio
2025-04-09 13:29:11,074 - detailed - INFO - Extracting audio from DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:29:11,124 - detailed - INFO - DICOM file read successfully on attempt 1
2025-04-09 13:29:11,125 - detailed - INFO - Waveform extracted from DICOM file.
2025-04-09 13:29:11,157 - detailed - INFO - Audio extracted and saved to: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:29:11,158 - root - INFO - Updated study 1 status to transcribing
2025-04-09 13:29:11,159 - detailed - INFO - Transcribing audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav for DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:29:11,159 - detailed - DEBUG - Reading DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:29:11,171 - detailed - DEBUG - DICOM file read successfully
2025-04-09 13:29:11,171 - detailed - DEBUG - Uploading audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav to Gemini API
2025-04-09 13:29:11,912 - googleapiclient.http - WARNING - Invalid JSON content from response: b'<!DOCTYPE html>\n<html lang=en>\n  <meta charset=utf-8>\n  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">\n  <title>Error 403 (Forbidden)!!1</title>\n  <style>\n    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}\n  </style>\n  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>\n  <p><b>403.</b> <ins>That\xe2\x80\x99s an error.</ins>\n  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That\xe2\x80\x99s all we know.</ins>\n'
2025-04-09 13:29:11,914 - detailed - ERROR - Unexpected error while uploading audio: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">
2025-04-09 13:29:11,928 - detailed - DEBUG - Traceback (most recent call last):
  File "E:\SRwithenhancedSOP\modules\transcribe.py", line 41, in transcribe
    uploaded_file = genai.upload_file(audio_path)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 103, in create_file
    self._setup_discovery_api(metadata)
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 84, in _setup_discovery_api
    response, content = request.execute()
                        ^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">

2025-04-09 13:29:11,932 - root - WARNING - No transcription was generated.
2025-04-09 13:29:11,935 - root - INFO - Updated study 1 status to error
2025-04-09 13:29:11,952 - root - INFO - Temporary audio file deleted: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:29:14,439 - root - INFO - Subprocess for 1 completed successfully.
2025-04-09 13:29:14,439 - root - INFO - Processing study key from queue: 53
2025-04-09 13:29:16,420 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:29:16,437 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:29:16,437 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:29:16,437 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:29:16,438 - root - INFO - Connecting to Oracle database.
2025-04-09 13:29:16,511 - root - INFO - Creating cursor for database operations.
2025-04-09 13:29:16,522 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:29:17,066 - root - ERROR - Subprocess for 53 failed with code 1.
2025-04-09 13:29:17,066 - root - ERROR - Subprocess stderr: 2025-04-09 13:29:16,420 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:29:16,437 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:29:16,437 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:29:16,437 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:29:16,438 - root - INFO - Connecting to Oracle database.
2025-04-09 13:29:16,511 - root - INFO - Creating cursor for database operations.
2025-04-09 13:29:16,522 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm

2025-04-09 13:29:17,069 - root - INFO - Updated study 53 status to error
2025-04-09 13:29:17,069 - root - INFO - Processing study key from queue: 22
2025-04-09 13:29:19,095 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:29:19,101 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:29:19,102 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:29:19,102 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:29:19,102 - root - INFO - Connecting to Oracle database.
2025-04-09 13:29:19,170 - root - INFO - Creating cursor for database operations.
2025-04-09 13:29:19,177 - root - ERROR - No TDICTATION record found for REPORT_KEY=63
2025-04-09 13:29:19,735 - root - ERROR - Subprocess for 22 failed with code 1.
2025-04-09 13:29:19,735 - root - ERROR - Subprocess stderr: 2025-04-09 13:29:19,095 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:29:19,101 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:29:19,102 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:29:19,102 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:29:19,102 - root - INFO - Connecting to Oracle database.
2025-04-09 13:29:19,170 - root - INFO - Creating cursor for database operations.
2025-04-09 13:29:19,177 - root - ERROR - No TDICTATION record found for REPORT_KEY=63

2025-04-09 13:29:19,738 - root - INFO - Updated study 22 status to error
2025-04-09 13:30:08,780 - root - INFO - Detected study 1 with REPORT_STAT '3010'.
2025-04-09 13:30:08,783 - root - INFO - Updated study 1 status to received
2025-04-09 13:30:08,784 - root - INFO - Added study 1 to processing queue.
2025-04-09 13:30:08,784 - root - INFO - Processing study key from queue: 1
2025-04-09 13:30:08,785 - root - INFO - Detected study 53 with REPORT_STAT '3010'.
2025-04-09 13:30:08,789 - root - INFO - Updated study 53 status to received
2025-04-09 13:30:08,790 - root - INFO - Added study 53 to processing queue.
2025-04-09 13:30:08,791 - root - INFO - Detected study 22 with REPORT_STAT '3010'.
2025-04-09 13:30:08,792 - root - INFO - Updated study 22 status to received
2025-04-09 13:30:08,793 - root - INFO - Added study 22 to processing queue.
2025-04-09 13:30:11,023 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:30:11,030 - root - INFO - Updated study 1 status to processing_query
2025-04-09 13:30:11,030 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:30:11,030 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:30:11,031 - root - INFO - Connecting to Oracle database.
2025-04-09 13:30:11,109 - root - INFO - Creating cursor for database operations.
2025-04-09 13:30:11,134 - root - INFO - DICOM file path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:30:11,134 - root - INFO - UNC path detected: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm. Attempting network share connection.
2025-04-09 13:30:11,135 - root - INFO - Attempting connection to network share: \\172.31.100.60\Longterm
2025-04-09 13:30:11,171 - root - WARNING - Connection to \\172.31.100.60\Longterm likely already exists or conflicts: Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Code: 1219). Assuming access is possible.
2025-04-09 13:30:11,171 - root - INFO - Network share connection successful or already established.
2025-04-09 13:30:11,172 - root - INFO - Updated study 1 status to processing_audio
2025-04-09 13:30:11,173 - detailed - INFO - Extracting audio from DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:30:11,240 - detailed - INFO - DICOM file read successfully on attempt 1
2025-04-09 13:30:11,241 - detailed - INFO - Waveform extracted from DICOM file.
2025-04-09 13:30:11,285 - detailed - INFO - Audio extracted and saved to: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:30:11,286 - root - INFO - Updated study 1 status to transcribing
2025-04-09 13:30:11,286 - detailed - INFO - Transcribing audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav for DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:30:11,287 - detailed - DEBUG - Reading DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:30:11,316 - detailed - DEBUG - DICOM file read successfully
2025-04-09 13:30:11,316 - detailed - DEBUG - Uploading audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav to Gemini API
2025-04-09 13:30:12,069 - googleapiclient.http - WARNING - Invalid JSON content from response: b'<!DOCTYPE html>\n<html lang=en>\n  <meta charset=utf-8>\n  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">\n  <title>Error 403 (Forbidden)!!1</title>\n  <style>\n    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}\n  </style>\n  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>\n  <p><b>403.</b> <ins>That\xe2\x80\x99s an error.</ins>\n  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That\xe2\x80\x99s all we know.</ins>\n'
2025-04-09 13:30:12,071 - detailed - ERROR - Unexpected error while uploading audio: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">
2025-04-09 13:30:12,080 - detailed - DEBUG - Traceback (most recent call last):
  File "E:\SRwithenhancedSOP\modules\transcribe.py", line 41, in transcribe
    uploaded_file = genai.upload_file(audio_path)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 103, in create_file
    self._setup_discovery_api(metadata)
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 84, in _setup_discovery_api
    response, content = request.execute()
                        ^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">

2025-04-09 13:30:12,083 - root - WARNING - No transcription was generated.
2025-04-09 13:30:12,086 - root - INFO - Updated study 1 status to error
2025-04-09 13:30:12,103 - root - INFO - Temporary audio file deleted: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:30:14,676 - root - INFO - Subprocess for 1 completed successfully.
2025-04-09 13:30:14,676 - root - INFO - Processing study key from queue: 53
2025-04-09 13:30:16,715 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:30:16,722 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:30:16,722 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:30:16,722 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:30:16,723 - root - INFO - Connecting to Oracle database.
2025-04-09 13:30:16,790 - root - INFO - Creating cursor for database operations.
2025-04-09 13:30:16,799 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:30:17,368 - root - ERROR - Subprocess for 53 failed with code 1.
2025-04-09 13:30:17,369 - root - ERROR - Subprocess stderr: 2025-04-09 13:30:16,715 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:30:16,722 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:30:16,722 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:30:16,722 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:30:16,723 - root - INFO - Connecting to Oracle database.
2025-04-09 13:30:16,790 - root - INFO - Creating cursor for database operations.
2025-04-09 13:30:16,799 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm

2025-04-09 13:30:17,371 - root - INFO - Updated study 53 status to error
2025-04-09 13:30:17,372 - root - INFO - Processing study key from queue: 22
2025-04-09 13:30:19,452 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:30:19,458 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:30:19,458 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:30:19,459 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:30:19,459 - root - INFO - Connecting to Oracle database.
2025-04-09 13:30:19,527 - root - INFO - Creating cursor for database operations.
2025-04-09 13:30:19,532 - root - ERROR - No TDICTATION record found for REPORT_KEY=63
2025-04-09 13:30:20,087 - root - ERROR - Subprocess for 22 failed with code 1.
2025-04-09 13:30:20,087 - root - ERROR - Subprocess stderr: 2025-04-09 13:30:19,452 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:30:19,458 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:30:19,458 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:30:19,459 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:30:19,459 - root - INFO - Connecting to Oracle database.
2025-04-09 13:30:19,527 - root - INFO - Creating cursor for database operations.
2025-04-09 13:30:19,532 - root - ERROR - No TDICTATION record found for REPORT_KEY=63

2025-04-09 13:30:20,090 - root - INFO - Updated study 22 status to error
2025-04-09 13:31:08,844 - root - INFO - Detected study 1 with REPORT_STAT '3010'.
2025-04-09 13:31:08,848 - root - INFO - Updated study 1 status to received
2025-04-09 13:31:08,850 - root - INFO - Added study 1 to processing queue.
2025-04-09 13:31:08,850 - root - INFO - Processing study key from queue: 1
2025-04-09 13:31:08,851 - root - INFO - Detected study 53 with REPORT_STAT '3010'.
2025-04-09 13:31:08,854 - root - INFO - Updated study 53 status to received
2025-04-09 13:31:08,855 - root - INFO - Added study 53 to processing queue.
2025-04-09 13:31:08,856 - root - INFO - Detected study 22 with REPORT_STAT '3010'.
2025-04-09 13:31:08,858 - root - INFO - Updated study 22 status to received
2025-04-09 13:31:08,859 - root - INFO - Added study 22 to processing queue.
2025-04-09 13:31:10,889 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:31:10,897 - root - INFO - Updated study 1 status to processing_query
2025-04-09 13:31:10,897 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:31:10,897 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:31:10,897 - root - INFO - Connecting to Oracle database.
2025-04-09 13:31:10,994 - root - INFO - Creating cursor for database operations.
2025-04-09 13:31:11,010 - root - INFO - DICOM file path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:31:11,010 - root - INFO - UNC path detected: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm. Attempting network share connection.
2025-04-09 13:31:11,010 - root - INFO - Attempting connection to network share: \\172.31.100.60\Longterm
2025-04-09 13:31:11,124 - root - WARNING - Connection to \\172.31.100.60\Longterm likely already exists or conflicts: Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Code: 1219). Assuming access is possible.
2025-04-09 13:31:11,125 - root - INFO - Network share connection successful or already established.
2025-04-09 13:31:11,126 - root - INFO - Updated study 1 status to processing_audio
2025-04-09 13:31:11,126 - detailed - INFO - Extracting audio from DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:31:11,165 - detailed - INFO - DICOM file read successfully on attempt 1
2025-04-09 13:31:11,165 - detailed - INFO - Waveform extracted from DICOM file.
2025-04-09 13:31:11,262 - detailed - INFO - Audio extracted and saved to: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:31:11,263 - root - INFO - Updated study 1 status to transcribing
2025-04-09 13:31:11,263 - detailed - INFO - Transcribing audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav for DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:31:11,264 - detailed - DEBUG - Reading DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:31:11,308 - detailed - DEBUG - DICOM file read successfully
2025-04-09 13:31:11,308 - detailed - DEBUG - Uploading audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav to Gemini API
2025-04-09 13:31:12,052 - googleapiclient.http - WARNING - Invalid JSON content from response: b'<!DOCTYPE html>\n<html lang=en>\n  <meta charset=utf-8>\n  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">\n  <title>Error 403 (Forbidden)!!1</title>\n  <style>\n    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}\n  </style>\n  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>\n  <p><b>403.</b> <ins>That\xe2\x80\x99s an error.</ins>\n  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That\xe2\x80\x99s all we know.</ins>\n'
2025-04-09 13:31:12,053 - detailed - ERROR - Unexpected error while uploading audio: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">
2025-04-09 13:31:12,056 - detailed - DEBUG - Traceback (most recent call last):
  File "E:\SRwithenhancedSOP\modules\transcribe.py", line 41, in transcribe
    uploaded_file = genai.upload_file(audio_path)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 103, in create_file
    self._setup_discovery_api(metadata)
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 84, in _setup_discovery_api
    response, content = request.execute()
                        ^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">

2025-04-09 13:31:12,057 - root - WARNING - No transcription was generated.
2025-04-09 13:31:12,059 - root - INFO - Updated study 1 status to error
2025-04-09 13:31:12,075 - root - INFO - Temporary audio file deleted: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:31:14,562 - root - INFO - Subprocess for 1 completed successfully.
2025-04-09 13:31:14,562 - root - INFO - Processing study key from queue: 53
2025-04-09 13:31:16,586 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:31:16,593 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:31:16,593 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:31:16,593 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:31:16,593 - root - INFO - Connecting to Oracle database.
2025-04-09 13:31:16,661 - root - INFO - Creating cursor for database operations.
2025-04-09 13:31:16,671 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:31:17,215 - root - ERROR - Subprocess for 53 failed with code 1.
2025-04-09 13:31:17,216 - root - ERROR - Subprocess stderr: 2025-04-09 13:31:16,586 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:31:16,593 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:31:16,593 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:31:16,593 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:31:16,593 - root - INFO - Connecting to Oracle database.
2025-04-09 13:31:16,661 - root - INFO - Creating cursor for database operations.
2025-04-09 13:31:16,671 - root - ERROR - File not found at constructed path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm

2025-04-09 13:31:17,219 - root - INFO - Updated study 53 status to error
2025-04-09 13:31:17,219 - root - INFO - Processing study key from queue: 22
2025-04-09 13:31:19,275 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:31:19,282 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:31:19,282 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:31:19,283 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:31:19,283 - root - INFO - Connecting to Oracle database.
2025-04-09 13:31:19,346 - root - INFO - Creating cursor for database operations.
2025-04-09 13:31:19,352 - root - ERROR - No TDICTATION record found for REPORT_KEY=63
2025-04-09 13:31:19,946 - root - ERROR - Subprocess for 22 failed with code 1.
2025-04-09 13:31:19,947 - root - ERROR - Subprocess stderr: 2025-04-09 13:31:19,275 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:31:19,282 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:31:19,282 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:31:19,283 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:31:19,283 - root - INFO - Connecting to Oracle database.
2025-04-09 13:31:19,346 - root - INFO - Creating cursor for database operations.
2025-04-09 13:31:19,352 - root - ERROR - No TDICTATION record found for REPORT_KEY=63

2025-04-09 13:31:19,949 - root - INFO - Updated study 22 status to error
2025-04-09 13:31:26,854 - root - INFO - Database monitoring stopped by user.
2025-04-09 13:32:46,978 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:32:46,984 - root - INFO - Starting database monitor mode...
2025-04-09 13:32:47,231 - root - INFO - Connected to Oracle database for monitoring.
2025-04-09 13:32:47,253 - root - INFO - Detected study 721 with REPORT_STAT '3010'.
2025-04-09 13:32:47,254 - root - INFO - Created new study record for 721 with status received
2025-04-09 13:32:47,291 - root - INFO - Added study 721 to processing queue.
2025-04-09 13:32:47,292 - root - INFO - Processing study key from queue: 721
2025-04-09 13:32:49,368 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:32:49,375 - root - INFO - Created new study record for 721 with status processing_query
2025-04-09 13:32:49,375 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:32:49,376 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.58)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:32:49,376 - root - INFO - Connecting to Oracle database.
2025-04-09 13:32:49,453 - root - INFO - Creating cursor for database operations.
2025-04-09 13:32:49,972 - root - ERROR - File not found at constructed path: \\172.31.100.58\Longterm01\2024\12\26\AU\ANON\1.2.410.200058.2.2.98.01.1.101\1.2.276.0.7230010.3.1.4.2563830456.8596.1737441830.787_5748.dcm
2025-04-09 13:32:50,497 - root - ERROR - Subprocess for 721 failed with code 1.
2025-04-09 13:32:50,497 - root - ERROR - Subprocess stderr: 2025-04-09 13:32:49,368 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:32:49,375 - root - INFO - Created new study record for 721 with status processing_query
2025-04-09 13:32:49,375 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:32:49,376 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.58)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:32:49,376 - root - INFO - Connecting to Oracle database.
2025-04-09 13:32:49,453 - root - INFO - Creating cursor for database operations.
2025-04-09 13:32:49,972 - root - ERROR - File not found at constructed path: \\172.31.100.58\Longterm01\2024\12\26\AU\ANON\1.2.410.200058.2.2.98.01.1.101\1.2.276.0.7230010.3.1.4.2563830456.8596.1737441830.787_5748.dcm

2025-04-09 13:32:50,501 - root - INFO - Updated study 721 status to error
2025-04-09 13:33:47,333 - root - INFO - Detected study 721 with REPORT_STAT '3010'.
2025-04-09 13:33:47,338 - root - INFO - Updated study 721 status to received
2025-04-09 13:33:47,340 - root - INFO - Added study 721 to processing queue.
2025-04-09 13:33:47,340 - root - INFO - Processing study key from queue: 721
2025-04-09 13:33:49,391 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:33:49,410 - root - INFO - Updated study 721 status to processing_query
2025-04-09 13:33:49,411 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:33:49,411 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.58)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:33:49,411 - root - INFO - Connecting to Oracle database.
2025-04-09 13:33:49,497 - root - INFO - Creating cursor for database operations.
2025-04-09 13:33:49,547 - root - ERROR - File not found at constructed path: \\172.31.100.58\Longterm01\2024\12\26\AU\ANON\1.2.410.200058.2.2.98.01.1.101\1.2.276.0.7230010.3.1.4.2563830456.8596.1737441830.787_5748.dcm
2025-04-09 13:33:50,031 - root - ERROR - Subprocess for 721 failed with code 1.
2025-04-09 13:33:50,032 - root - ERROR - Subprocess stderr: 2025-04-09 13:33:49,391 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:33:49,410 - root - INFO - Updated study 721 status to processing_query
2025-04-09 13:33:49,411 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:33:49,411 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.58)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:33:49,411 - root - INFO - Connecting to Oracle database.
2025-04-09 13:33:49,497 - root - INFO - Creating cursor for database operations.
2025-04-09 13:33:49,547 - root - ERROR - File not found at constructed path: \\172.31.100.58\Longterm01\2024\12\26\AU\ANON\1.2.410.200058.2.2.98.01.1.101\1.2.276.0.7230010.3.1.4.2563830456.8596.1737441830.787_5748.dcm

2025-04-09 13:33:50,035 - root - INFO - Updated study 721 status to error
2025-04-09 13:34:47,384 - root - INFO - Detected study 721 with REPORT_STAT '3010'.
2025-04-09 13:34:47,386 - root - INFO - Updated study 721 status to received
2025-04-09 13:34:47,387 - root - INFO - Added study 721 to processing queue.
2025-04-09 13:34:47,387 - root - INFO - Processing study key from queue: 721
2025-04-09 13:34:49,436 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:34:49,443 - root - INFO - Updated study 721 status to processing_query
2025-04-09 13:34:49,444 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:34:49,444 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.58)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:34:49,444 - root - INFO - Connecting to Oracle database.
2025-04-09 13:34:49,501 - root - INFO - Creating cursor for database operations.
2025-04-09 13:34:49,707 - root - ERROR - File not found at constructed path: \\172.31.100.58\Longterm01\2024\12\26\AU\ANON\1.2.410.200058.2.2.98.01.1.101\1.2.276.0.7230010.3.1.4.2563830456.8596.1737441830.787_5748.dcm
2025-04-09 13:34:50,074 - root - ERROR - Subprocess for 721 failed with code 1.
2025-04-09 13:34:50,075 - root - ERROR - Subprocess stderr: 2025-04-09 13:34:49,436 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:34:49,443 - root - INFO - Updated study 721 status to processing_query
2025-04-09 13:34:49,444 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:34:49,444 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.58)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:34:49,444 - root - INFO - Connecting to Oracle database.
2025-04-09 13:34:49,501 - root - INFO - Creating cursor for database operations.
2025-04-09 13:34:49,707 - root - ERROR - File not found at constructed path: \\172.31.100.58\Longterm01\2024\12\26\AU\ANON\1.2.410.200058.2.2.98.01.1.101\1.2.276.0.7230010.3.1.4.2563830456.8596.1737441830.787_5748.dcm

2025-04-09 13:34:50,078 - root - INFO - Updated study 721 status to error
2025-04-09 13:35:47,424 - root - INFO - Detected study 721 with REPORT_STAT '3010'.
2025-04-09 13:35:47,430 - root - INFO - Updated study 721 status to received
2025-04-09 13:35:47,432 - root - INFO - Added study 721 to processing queue.
2025-04-09 13:35:47,432 - root - INFO - Processing study key from queue: 721
2025-04-09 13:35:49,459 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:35:49,477 - root - INFO - Updated study 721 status to processing_query
2025-04-09 13:35:49,477 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:35:49,478 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.58)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:35:49,478 - root - INFO - Connecting to Oracle database.
2025-04-09 13:35:49,555 - root - INFO - Creating cursor for database operations.
2025-04-09 13:35:49,598 - root - ERROR - File not found at constructed path: \\172.31.100.58\Longterm01\2024\12\26\AU\ANON\1.2.410.200058.2.2.98.01.1.101\1.2.276.0.7230010.3.1.4.2563830456.8596.1737441830.787_5748.dcm
2025-04-09 13:35:50,088 - root - ERROR - Subprocess for 721 failed with code 1.
2025-04-09 13:35:50,089 - root - ERROR - Subprocess stderr: 2025-04-09 13:35:49,459 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:35:49,477 - root - INFO - Updated study 721 status to processing_query
2025-04-09 13:35:49,477 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:35:49,478 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.58)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:35:49,478 - root - INFO - Connecting to Oracle database.
2025-04-09 13:35:49,555 - root - INFO - Creating cursor for database operations.
2025-04-09 13:35:49,598 - root - ERROR - File not found at constructed path: \\172.31.100.58\Longterm01\2024\12\26\AU\ANON\1.2.410.200058.2.2.98.01.1.101\1.2.276.0.7230010.3.1.4.2563830456.8596.1737441830.787_5748.dcm

2025-04-09 13:35:50,091 - root - INFO - Updated study 721 status to error
2025-04-09 13:35:59,476 - root - INFO - Database monitoring stopped by user.
2025-04-09 13:47:49,925 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:47:49,931 - root - INFO - Starting database monitor mode...
2025-04-09 13:47:49,989 - root - INFO - Connected to Oracle database for monitoring.
2025-04-09 13:47:49,993 - root - INFO - Detected study 1 with REPORT_STAT '3010'.
2025-04-09 13:47:49,995 - root - INFO - Updated study 1 status to received
2025-04-09 13:47:49,995 - root - INFO - Added study 1 to processing queue.
2025-04-09 13:47:49,995 - root - INFO - Processing study key from queue: 1
2025-04-09 13:47:49,996 - root - INFO - Detected study 53 with REPORT_STAT '3010'.
2025-04-09 13:47:49,998 - root - INFO - Updated study 53 status to received
2025-04-09 13:47:49,998 - root - INFO - Added study 53 to processing queue.
2025-04-09 13:47:49,999 - root - INFO - Detected study 22 with REPORT_STAT '3010'.
2025-04-09 13:47:50,000 - root - INFO - Updated study 22 status to received
2025-04-09 13:47:50,001 - root - INFO - Added study 22 to processing queue.
2025-04-09 13:47:52,029 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:47:52,036 - root - INFO - Updated study 1 status to processing_query
2025-04-09 13:47:52,036 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:47:52,037 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:47:52,037 - root - INFO - Connecting to Oracle database.
2025-04-09 13:47:52,109 - root - INFO - Creating cursor for database operations.
2025-04-09 13:47:52,118 - root - INFO - Constructed potential DICOM path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:47:52,121 - root - INFO - DICOM file path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:47:52,121 - root - INFO - UNC path detected: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm. Attempting network share connection.
2025-04-09 13:47:52,121 - root - INFO - Attempting connection to network share: \\172.31.100.60\Longterm
2025-04-09 13:47:52,247 - root - WARNING - Connection to \\172.31.100.60\Longterm likely already exists or conflicts: Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Code: 1219). Assuming access is possible.
2025-04-09 13:47:52,248 - root - INFO - Network share connection successful or already established.
2025-04-09 13:47:52,249 - root - INFO - Updated study 1 status to processing_audio
2025-04-09 13:47:52,249 - detailed - INFO - Extracting audio from DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:47:52,290 - detailed - INFO - DICOM file read successfully on attempt 1
2025-04-09 13:47:52,290 - detailed - INFO - Waveform extracted from DICOM file.
2025-04-09 13:47:52,316 - detailed - INFO - Audio extracted and saved to: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:47:52,317 - root - INFO - Updated study 1 status to transcribing
2025-04-09 13:47:52,318 - detailed - INFO - Transcribing audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav for DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:47:52,318 - detailed - DEBUG - Reading DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:47:52,328 - detailed - DEBUG - DICOM file read successfully
2025-04-09 13:47:52,328 - detailed - DEBUG - Uploading audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav to Gemini API
2025-04-09 13:47:53,386 - googleapiclient.http - WARNING - Invalid JSON content from response: b'<!DOCTYPE html>\n<html lang=en>\n  <meta charset=utf-8>\n  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">\n  <title>Error 403 (Forbidden)!!1</title>\n  <style>\n    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}\n  </style>\n  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>\n  <p><b>403.</b> <ins>That\xe2\x80\x99s an error.</ins>\n  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That\xe2\x80\x99s all we know.</ins>\n'
2025-04-09 13:47:53,387 - detailed - ERROR - Unexpected error while uploading audio: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">
2025-04-09 13:47:53,392 - detailed - DEBUG - Traceback (most recent call last):
  File "E:\SRwithenhancedSOP\modules\transcribe.py", line 41, in transcribe
    uploaded_file = genai.upload_file(audio_path)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 103, in create_file
    self._setup_discovery_api(metadata)
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 84, in _setup_discovery_api
    response, content = request.execute()
                        ^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">

2025-04-09 13:47:53,394 - root - WARNING - No transcription was generated.
2025-04-09 13:47:53,395 - root - INFO - Updated study 1 status to error
2025-04-09 13:47:53,437 - root - INFO - Temporary audio file deleted: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:47:55,692 - root - INFO - Subprocess for 1 completed successfully.
2025-04-09 13:47:55,693 - root - INFO - Processing study key from queue: 53
2025-04-09 13:47:57,658 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:47:57,665 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:47:57,665 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:47:57,665 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:47:57,665 - root - INFO - Connecting to Oracle database.
2025-04-09 13:47:57,727 - root - INFO - Creating cursor for database operations.
2025-04-09 13:47:57,735 - root - INFO - Constructed potential DICOM path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:47:57,738 - root - INFO - DICOM file path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:47:57,740 - root - INFO - UNC path detected: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm. Attempting network share connection.
2025-04-09 13:47:57,741 - root - INFO - Attempting connection to network share: \\172.31.100.60\Longterm
2025-04-09 13:47:57,833 - root - WARNING - Connection to \\172.31.100.60\Longterm likely already exists or conflicts: Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Code: 1219). Assuming access is possible.
2025-04-09 13:47:57,833 - root - INFO - Network share connection successful or already established.
2025-04-09 13:47:57,834 - root - INFO - Updated study 53 status to processing_audio
2025-04-09 13:47:57,835 - detailed - INFO - Extracting audio from DICOM file: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:47:57,837 - detailed - ERROR - File does not exist: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:47:57,837 - root - ERROR - Pipeline error (FileNotFound) for study key 53: File does not exist: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:47:57,838 - root - INFO - Updated study 53 status to error
2025-04-09 13:47:58,293 - root - INFO - Subprocess for 53 completed successfully.
2025-04-09 13:47:58,293 - root - INFO - Processing study key from queue: 22
2025-04-09 13:48:00,281 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:48:00,288 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:48:00,288 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:48:00,288 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:48:00,289 - root - INFO - Connecting to Oracle database.
2025-04-09 13:48:00,337 - root - INFO - Creating cursor for database operations.
2025-04-09 13:48:00,341 - root - ERROR - No TDICTATION record found for REPORT_KEY=63
2025-04-09 13:48:00,910 - root - ERROR - Subprocess for 22 failed with code 1.
2025-04-09 13:48:00,911 - root - ERROR - Subprocess stderr: 2025-04-09 13:48:00,281 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:48:00,288 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:48:00,288 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:48:00,288 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:48:00,289 - root - INFO - Connecting to Oracle database.
2025-04-09 13:48:00,337 - root - INFO - Creating cursor for database operations.
2025-04-09 13:48:00,341 - root - ERROR - No TDICTATION record found for REPORT_KEY=63

2025-04-09 13:48:00,914 - root - INFO - Updated study 22 status to error
2025-04-09 13:48:50,043 - root - INFO - Detected study 1 with REPORT_STAT '3010'.
2025-04-09 13:48:50,049 - root - INFO - Updated study 1 status to received
2025-04-09 13:48:50,051 - root - INFO - Added study 1 to processing queue.
2025-04-09 13:48:50,051 - root - INFO - Processing study key from queue: 1
2025-04-09 13:48:50,053 - root - INFO - Detected study 53 with REPORT_STAT '3010'.
2025-04-09 13:48:50,059 - root - INFO - Updated study 53 status to received
2025-04-09 13:48:50,061 - root - INFO - Added study 53 to processing queue.
2025-04-09 13:48:50,064 - root - INFO - Detected study 22 with REPORT_STAT '3010'.
2025-04-09 13:48:50,066 - root - INFO - Updated study 22 status to received
2025-04-09 13:48:50,067 - root - INFO - Added study 22 to processing queue.
2025-04-09 13:48:52,093 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:48:52,101 - root - INFO - Updated study 1 status to processing_query
2025-04-09 13:48:52,101 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:48:52,101 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:48:52,101 - root - INFO - Connecting to Oracle database.
2025-04-09 13:48:52,172 - root - INFO - Creating cursor for database operations.
2025-04-09 13:48:52,180 - root - INFO - Constructed potential DICOM path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:48:52,183 - root - INFO - DICOM file path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:48:52,184 - root - INFO - UNC path detected: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm. Attempting network share connection.
2025-04-09 13:48:52,185 - root - INFO - Attempting connection to network share: \\172.31.100.60\Longterm
2025-04-09 13:48:52,223 - root - WARNING - Connection to \\172.31.100.60\Longterm likely already exists or conflicts: Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Code: 1219). Assuming access is possible.
2025-04-09 13:48:52,223 - root - INFO - Network share connection successful or already established.
2025-04-09 13:48:52,225 - root - INFO - Updated study 1 status to processing_audio
2025-04-09 13:48:52,225 - detailed - INFO - Extracting audio from DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:48:52,268 - detailed - INFO - DICOM file read successfully on attempt 1
2025-04-09 13:48:52,268 - detailed - INFO - Waveform extracted from DICOM file.
2025-04-09 13:48:52,293 - detailed - INFO - Audio extracted and saved to: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:48:52,295 - root - INFO - Updated study 1 status to transcribing
2025-04-09 13:48:52,295 - detailed - INFO - Transcribing audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav for DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:48:52,296 - detailed - DEBUG - Reading DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:48:52,307 - detailed - DEBUG - DICOM file read successfully
2025-04-09 13:48:52,308 - detailed - DEBUG - Uploading audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav to Gemini API
2025-04-09 13:48:53,069 - googleapiclient.http - WARNING - Invalid JSON content from response: b'<!DOCTYPE html>\n<html lang=en>\n  <meta charset=utf-8>\n  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">\n  <title>Error 403 (Forbidden)!!1</title>\n  <style>\n    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}\n  </style>\n  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>\n  <p><b>403.</b> <ins>That\xe2\x80\x99s an error.</ins>\n  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That\xe2\x80\x99s all we know.</ins>\n'
2025-04-09 13:48:53,071 - detailed - ERROR - Unexpected error while uploading audio: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">
2025-04-09 13:48:53,085 - detailed - DEBUG - Traceback (most recent call last):
  File "E:\SRwithenhancedSOP\modules\transcribe.py", line 41, in transcribe
    uploaded_file = genai.upload_file(audio_path)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 103, in create_file
    self._setup_discovery_api(metadata)
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 84, in _setup_discovery_api
    response, content = request.execute()
                        ^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">

2025-04-09 13:48:53,090 - root - WARNING - No transcription was generated.
2025-04-09 13:48:53,095 - root - INFO - Updated study 1 status to error
2025-04-09 13:48:53,117 - root - INFO - Temporary audio file deleted: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:48:55,756 - root - INFO - Subprocess for 1 completed successfully.
2025-04-09 13:48:55,756 - root - INFO - Processing study key from queue: 53
2025-04-09 13:48:57,747 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:48:57,765 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:48:57,765 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:48:57,765 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:48:57,766 - root - INFO - Connecting to Oracle database.
2025-04-09 13:48:57,844 - root - INFO - Creating cursor for database operations.
2025-04-09 13:48:57,853 - root - INFO - Constructed potential DICOM path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:48:57,856 - root - INFO - DICOM file path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:48:57,857 - root - INFO - UNC path detected: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm. Attempting network share connection.
2025-04-09 13:48:57,858 - root - INFO - Attempting connection to network share: \\172.31.100.60\Longterm
2025-04-09 13:48:57,894 - root - WARNING - Connection to \\172.31.100.60\Longterm likely already exists or conflicts: Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Code: 1219). Assuming access is possible.
2025-04-09 13:48:57,895 - root - INFO - Network share connection successful or already established.
2025-04-09 13:48:57,896 - root - INFO - Updated study 53 status to processing_audio
2025-04-09 13:48:57,896 - detailed - INFO - Extracting audio from DICOM file: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:48:57,899 - detailed - ERROR - File does not exist: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:48:57,899 - root - ERROR - Pipeline error (FileNotFound) for study key 53: File does not exist: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:48:57,901 - root - INFO - Updated study 53 status to error
2025-04-09 13:48:58,380 - root - INFO - Subprocess for 53 completed successfully.
2025-04-09 13:48:58,381 - root - INFO - Processing study key from queue: 22
2025-04-09 13:49:00,325 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:49:00,332 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:49:00,332 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:49:00,332 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:49:00,332 - root - INFO - Connecting to Oracle database.
2025-04-09 13:49:00,386 - root - INFO - Creating cursor for database operations.
2025-04-09 13:49:00,390 - root - ERROR - No TDICTATION record found for REPORT_KEY=63
2025-04-09 13:49:00,952 - root - ERROR - Subprocess for 22 failed with code 1.
2025-04-09 13:49:00,953 - root - ERROR - Subprocess stderr: 2025-04-09 13:49:00,325 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:49:00,332 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:49:00,332 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:49:00,332 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:49:00,332 - root - INFO - Connecting to Oracle database.
2025-04-09 13:49:00,386 - root - INFO - Creating cursor for database operations.
2025-04-09 13:49:00,390 - root - ERROR - No TDICTATION record found for REPORT_KEY=63

2025-04-09 13:49:00,956 - root - INFO - Updated study 22 status to error
2025-04-09 13:49:50,105 - root - INFO - Detected study 1 with REPORT_STAT '3010'.
2025-04-09 13:49:50,106 - root - INFO - Updated study 1 status to received
2025-04-09 13:49:50,107 - root - INFO - Added study 1 to processing queue.
2025-04-09 13:49:50,107 - root - INFO - Processing study key from queue: 1
2025-04-09 13:49:50,107 - root - INFO - Detected study 53 with REPORT_STAT '3010'.
2025-04-09 13:49:50,109 - root - INFO - Updated study 53 status to received
2025-04-09 13:49:50,110 - root - INFO - Added study 53 to processing queue.
2025-04-09 13:49:50,111 - root - INFO - Detected study 22 with REPORT_STAT '3010'.
2025-04-09 13:49:50,112 - root - INFO - Updated study 22 status to received
2025-04-09 13:49:50,113 - root - INFO - Added study 22 to processing queue.
2025-04-09 13:49:52,075 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:49:52,082 - root - INFO - Updated study 1 status to processing_query
2025-04-09 13:49:52,082 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:49:52,082 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:49:52,082 - root - INFO - Connecting to Oracle database.
2025-04-09 13:49:52,153 - root - INFO - Creating cursor for database operations.
2025-04-09 13:49:52,162 - root - INFO - Constructed potential DICOM path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:49:52,164 - root - INFO - DICOM file path: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:49:52,164 - root - INFO - UNC path detected: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm. Attempting network share connection.
2025-04-09 13:49:52,165 - root - INFO - Attempting connection to network share: \\172.31.100.60\Longterm
2025-04-09 13:49:52,306 - root - WARNING - Connection to \\172.31.100.60\Longterm likely already exists or conflicts: Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Code: 1219). Assuming access is possible.
2025-04-09 13:49:52,307 - root - INFO - Network share connection successful or already established.
2025-04-09 13:49:52,308 - root - INFO - Updated study 1 status to processing_audio
2025-04-09 13:49:52,308 - detailed - INFO - Extracting audio from DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:49:52,355 - detailed - INFO - DICOM file read successfully on attempt 1
2025-04-09 13:49:52,355 - detailed - INFO - Waveform extracted from DICOM file.
2025-04-09 13:49:52,382 - detailed - INFO - Audio extracted and saved to: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:49:52,384 - root - INFO - Updated study 1 status to transcribing
2025-04-09 13:49:52,384 - detailed - INFO - Transcribing audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav for DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:49:52,384 - detailed - DEBUG - Reading DICOM file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.dcm
2025-04-09 13:49:52,398 - detailed - DEBUG - DICOM file read successfully
2025-04-09 13:49:52,398 - detailed - DEBUG - Uploading audio file: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav to Gemini API
2025-04-09 13:49:53,205 - googleapiclient.http - WARNING - Invalid JSON content from response: b'<!DOCTYPE html>\n<html lang=en>\n  <meta charset=utf-8>\n  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">\n  <title>Error 403 (Forbidden)!!1</title>\n  <style>\n    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}\n  </style>\n  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>\n  <p><b>403.</b> <ins>That\xe2\x80\x99s an error.</ins>\n  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That\xe2\x80\x99s all we know.</ins>\n'
2025-04-09 13:49:53,205 - detailed - ERROR - Unexpected error while uploading audio: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">
2025-04-09 13:49:53,209 - detailed - DEBUG - Traceback (most recent call last):
  File "E:\SRwithenhancedSOP\modules\transcribe.py", line 41, in transcribe
    uploaded_file = genai.upload_file(audio_path)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\files.py", line 85, in upload_file
    response = client.create_file(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 103, in create_file
    self._setup_discovery_api(metadata)
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\google\generativeai\client.py", line 84, in _setup_discovery_api
    response, content = request.execute()
                        ^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\02-06-06\miniconda3\envs\google-ai\Lib\site-packages\googleapiclient\http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 403 when requesting https://generativelanguage.googleapis.com/$discovery/rest?version=v1beta&key=AIzaSyCtch3XLoQtYSbQuAFiHhuluqrzWr88rH4 returned "Forbidden". Details: "<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 403 (Forbidden)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>403.</b> <ins>That’s an error.</ins>
  <p>Your client does not have permission to get URL <code>/$discovery/rest</code> from this server.  <ins>That’s all we know.</ins>
">

2025-04-09 13:49:53,211 - root - WARNING - No transcription was generated.
2025-04-09 13:49:53,212 - root - INFO - Updated study 1 status to error
2025-04-09 13:49:53,226 - root - INFO - Temporary audio file deleted: \\172.31.100.60\Longterm\2025\01\24\AU\1260408116\1.3.12.2.1107.5.2.18.142044.30000025012404145038500000043\1.2.276.0.7230010.3.1.4.1605365322.24844.1740917301.836_9564.wav
2025-04-09 13:49:55,789 - root - INFO - Subprocess for 1 completed successfully.
2025-04-09 13:49:55,790 - root - INFO - Processing study key from queue: 53
2025-04-09 13:49:57,802 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:49:57,809 - root - INFO - Updated study 53 status to processing_query
2025-04-09 13:49:57,810 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:49:57,810 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:49:57,810 - root - INFO - Connecting to Oracle database.
2025-04-09 13:49:57,857 - root - INFO - Creating cursor for database operations.
2025-04-09 13:49:57,863 - root - INFO - Constructed potential DICOM path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:49:57,866 - root - INFO - DICOM file path: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:49:57,866 - root - INFO - UNC path detected: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm. Attempting network share connection.
2025-04-09 13:49:57,867 - root - INFO - Attempting connection to network share: \\172.31.100.60\Longterm
2025-04-09 13:49:57,939 - root - WARNING - Connection to \\172.31.100.60\Longterm likely already exists or conflicts: Multiple connections to a server or shared resource by the same user, using more than one user name, are not allowed. Disconnect all previous connections to the server or shared resource and try again. (Code: 1219). Assuming access is possible.
2025-04-09 13:49:57,940 - root - INFO - Network share connection successful or already established.
2025-04-09 13:49:57,941 - root - INFO - Updated study 53 status to processing_audio
2025-04-09 13:49:57,941 - detailed - INFO - Extracting audio from DICOM file: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:49:57,944 - detailed - ERROR - File does not exist: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:49:57,944 - root - ERROR - Pipeline error (FileNotFound) for study key 53: File does not exist: \\172.31.100.60\Longterm\2025\01\26\AU\0052056473\1.3.12.2.1107.5.2.18.142044.30000025012606594607000000020\1.2.276.0.7230010.3.1.4.1857064875.22400.1741074815.672_9924.dcm
2025-04-09 13:49:57,945 - root - INFO - Updated study 53 status to error
2025-04-09 13:49:58,462 - root - INFO - Subprocess for 53 completed successfully.
2025-04-09 13:49:58,462 - root - INFO - Processing study key from queue: 22
2025-04-09 13:50:00,532 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:50:00,539 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:50:00,539 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:50:00,540 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:50:00,540 - root - INFO - Connecting to Oracle database.
2025-04-09 13:50:00,613 - root - INFO - Creating cursor for database operations.
2025-04-09 13:50:00,619 - root - ERROR - No TDICTATION record found for REPORT_KEY=63
2025-04-09 13:50:01,204 - root - ERROR - Subprocess for 22 failed with code 1.
2025-04-09 13:50:01,204 - root - ERROR - Subprocess stderr: 2025-04-09 13:50:00,532 - root - INFO - Successfully connected to MongoDB database: audio_transcriber_db
2025-04-09 13:50:00,539 - root - INFO - Updated study 22 status to processing_query
2025-04-09 13:50:00,539 - root - INFO - Creating DSN for Oracle connection.
2025-04-09 13:50:00,540 - root - INFO - DSN: (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=172.31.100.60)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=persiangulf)))
2025-04-09 13:50:00,540 - root - INFO - Connecting to Oracle database.
2025-04-09 13:50:00,613 - root - INFO - Creating cursor for database operations.
2025-04-09 13:50:00,619 - root - ERROR - No TDICTATION record found for REPORT_KEY=63

2025-04-09 13:50:01,207 - root - INFO - Updated study 22 status to error
2025-04-09 13:50:33,643 - root - INFO - Database monitoring stopped by user.
